<%- include('header') %>

<h2 class="text-lg font-bold text-gray-800 mb-4">주간 요약</h2>

<% if (weeklySummary) { %>
<div class="bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-xl p-5 mb-6">
  <h3 class="text-md font-bold text-purple-800 mb-2">AI 트렌드 분석</h3>
  <div class="text-sm text-gray-700 whitespace-pre-line"><%= weeklySummary %></div>
</div>
<% } else { %>
<div class="bg-yellow-50 border border-yellow-200 rounded-xl p-5 mb-6">
  <p class="text-sm text-yellow-700">아직 주간 요약이 생성되지 않았습니다. 매주 토요일에 자동 생성됩니다.</p>
</div>
<% } %>

<% if (articles && articles.length > 0) { %>
<h3 class="text-md font-bold text-gray-700 mb-3">이번 주 수집 기사 (<%= articles.length %>건)</h3>
<div class="grid gap-3 md:grid-cols-2 lg:grid-cols-3">
  <% var sorted = articles.sort(function(a, b) { return b.scores.total - a.scores.total; }).slice(0, 20); %>
  <% sorted.forEach(function(article, idx) { %>
  <% var sourceLabel = article.source === 'reddit' ? 'Reddit' : 'HN'; %>
  <% var sourceClass = article.source === 'reddit' ? 'source-reddit' : 'source-hackernews'; %>
  <div class="bg-white rounded-lg shadow-sm border p-3">
    <a href="<%= article.url %>" target="_blank" rel="noopener"
      class="text-sm font-medium text-gray-800 hover:text-blue-600 line-clamp-2 block mb-2">
      <%= article.title %>
    </a>
    <div class="flex items-center gap-2 text-xs">
      <span class="text-white px-2 py-0.5 rounded <%= sourceClass %>"><%= sourceLabel %></span>
      <span class="text-gray-500"><%= article.scores.total %>점</span>
      <span class="text-gray-400">👍 <%= article.points || article.score || 0 %></span>
    </div>
    <% if (article.summary) { %>
    <p class="text-xs text-gray-500 mt-2 line-clamp-2"><%= article.summary %></p>
    <% } %>
  </div>
  <% }); %>
</div>
<% } else { %>
<div class="text-center py-10">
  <p class="text-gray-500">이번 주에 수집된 기사가 없습니다.</p>
</div>
<% } %>

<%- include('footer') %>
